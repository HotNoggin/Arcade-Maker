// Includes
#include "Character.h"


Character::Character() {
	pixelRows = {};
}


Character::Character(std::array<Uint8, 16> pixels) {
	pixelRows = pixels;
}


// Returns true if there is a pixel at the pixel coordinate.
// Coordinates range from top-left (0, 0) to bottom-right (7, 15).
bool Character::getPixel(Uint8 x, Uint8 y) {
	if (x < 0 || y < 0 || x > 7 || y > 15) {
		return false;
	}
	return pixelRows[y] & (1 << (7 - x));
}


// Returns the index of the character in the allowed characters array.
// This index is the character's KIBIBOY codepoint.
// Returns codepoint 0 ('!') if the character doesn't appear.
Uint8 codepoint(char c) {
	for (int i = 0; i < characters.size(); i++) {
		if (characters[i] = c) {
			return i;
		}
	}
	return 0;
}


// All accepted KIBIBOY characters, ordered by KIBIBOY codepoint
std::array<char, 256> characters = {
	'!', '?', '"', '#', '$', '%', '&', '\'',
	'(', ')', '*', '+', ',', '-', '.', '/',
	'1', '2', '3', '4', '5', '6', '7', '8',
	'9', '0', ':', ';', '<', '=', '>', '@',
	'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H',
	'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 
	'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 
	'Y', 'Z', 
};

std::map<char, Character> font = {
	// Symbols 0, punctuation
	{'!', Character({0x0, 0x0, 0x0, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x18, 0x0, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{'?', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0x6, 0xc,
	0x18, 0x18, 0x0, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{'"', Character({0x0, 0x0, 0x0, 0x6c, 0x6c, 0x6c, 0x0, 0x0,
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{'#', Character({0x0, 0x0, 0x0, 0x6c, 0x6c, 0xfe, 0x6c, 0x6c,
	0x6c, 0xfe, 0x6c, 0x6c, 0x0, 0x0, 0x0, 0x0})},
	{'$', Character({0x0, 0x18, 0x18, 0x7c, 0xc6, 0xc6, 0xe0, 0x7c,
	0xe, 0xc6, 0xc6, 0x7c, 0x18, 0x18, 0x0, 0x0})},
	{'%', Character({0x0, 0x0, 0x0, 0x0, 0xe0, 0xa6, 0xec, 0x18,
	0x30, 0x6e, 0xca, 0xe, 0x0, 0x0, 0x0, 0x0})},
	{'&', Character({0x0, 0x0, 0x0, 0x70, 0xd8, 0xc0, 0x40, 0xf6,
	0xcc, 0xc8, 0xcc, 0x76, 0x0, 0x0, 0x0, 0x0})},
	{'\'', Character({0x0, 0x0, 0x0, 0x18, 0x18, 0x18, 0x0, 0x0,
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{'(', Character({0x0, 0x0, 0x0, 0x18, 0x30, 0x60, 0x60, 0x60,
	0x60, 0x60, 0x30, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{')', Character({0x0, 0x0, 0x0, 0x30, 0x18, 0xc, 0xc, 0xc,
	0xc, 0xc, 0x18, 0x30, 0x0, 0x0, 0x0, 0x0})},
	{'*', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x54, 0x38,
	0x54, 0x10, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{'+', Character({0x0, 0x0, 0x0, 0x0, 0x10, 0x10, 0x10, 0xfe,
	0x10, 0x10, 0x10, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{',', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	0x0, 0x0, 0x18, 0x18, 0x8, 0x10, 0x0, 0x0})},
	{'-', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfe, 0x0,
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{'.', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	0x0, 0x0, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{'/', Character({0x0, 0x0, 0xc, 0xc, 0x18, 0x18, 0x30, 0x30,
	0x30, 0x60, 0x60, 0xc0, 0xc0, 0x0, 0x0, 0x0})},
	
	// Numbers
	{'1', Character({0x0, 0x0, 0x0, 0x18, 0x78, 0x18, 0x18, 0x18,
	0x18, 0x18, 0x18, 0xfe, 0x0, 0x0, 0x0, 0x0})},
	{'2', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xe, 0x7c,
	0xe0, 0xc0, 0xc6, 0xfe, 0x0, 0x0, 0x0, 0x0})},
	{'3', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0x6, 0x1c,
	0x6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'4', Character({0x0, 0x0, 0x0, 0xcc, 0xcc, 0xcc, 0xcc, 0xfe,
	0xc, 0xc, 0xc, 0xc, 0x0, 0x0, 0x0, 0x0})},
	{'5', Character({0x0, 0x0, 0x0, 0xfe, 0xc6, 0xc0, 0xc0, 0x7c,
	0x6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'6', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc0, 0xfc,
	0xc6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'7', Character({0x0, 0x0, 0x0, 0xfe, 0xc6, 0x6, 0x6, 0xc,
	0x18, 0x18, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{'8', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc6, 0x7c,
	0xc6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'9', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc6, 0x7e,
	0x6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'0', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xce, 0xd6,
	0xe6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},

	// Symbols 1
	{':', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x18, 0x18, 0x0,
	0x0, 0x0, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{';', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x18, 0x18, 0x0,
	0x0, 0x0, 0x18, 0x18, 0x8, 0x10, 0x0, 0x0})},
	{'<', Character({0x0, 0x0, 0x0, 0x0, 0x6, 0x1e, 0x38, 0xe0,
	0xe0, 0x38, 0x1e, 0x6, 0x0, 0x0, 0x0, 0x0})},
	{'=', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfe, 0x0,
	0x0, 0xfe, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{'>', Character({0x0, 0x0, 0x0, 0x0, 0xc0, 0xf0, 0x38, 0xe,
	0xe, 0x38, 0xf0, 0xc0, 0x0, 0x0, 0x0, 0x0})},
	{'@', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xce, 0xd6, 0xd6,
	0xd6, 0xde, 0xc0, 0x7c, 0x0, 0x0, 0x0, 0x0})},

	// Latin capitals
	{'A', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc6, 0xfe,
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'B', Character({0x0, 0x0, 0x0, 0xfc, 0xc6, 0xc6, 0xc6, 0xfc, 
	0xc6, 0xc6, 0xc6, 0xfc, 0x0, 0x0, 0x0, 0x0})},
	{'C', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc0, 0xc0, 
	0xc0, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'D', Character({0x0, 0x0, 0x0, 0xfc, 0xc6, 0xc6, 0xc6, 0xc6, 
	0xc6, 0xc6, 0xc6, 0xfc, 0x0, 0x0, 0x0, 0x0})},
	{'E', Character({0x0, 0x0, 0x0, 0xfe, 0xc0, 0xc0, 0xc0, 0xf8, 
	0xc0, 0xc0, 0xc0, 0xfe, 0x0, 0x0, 0x0, 0x0})},
	{'F', Character({0x0, 0x0, 0x0, 0xfe, 0xc0, 0xc0, 0xc0, 0xf8, 
	0xc0, 0xc0, 0xc0, 0xc0, 0x0, 0x0, 0x0, 0x0})},
	{'G', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc0, 0xce,
	0xc6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'H', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xc6, 0xc6, 0xfe, 
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'I', Character({0x0, 0x0, 0x0, 0xfe, 0x18, 0x18, 0x18, 0x18, 
	0x18, 0x18, 0x18, 0xfe, 0x0, 0x0, 0x0, 0x0})},
	{'J', Character({0x0, 0x0, 0x0, 0xfe, 0xc, 0xc, 0xc, 0xc,
	0xc, 0xcc, 0xcc, 0x78, 0x0, 0x0, 0x0, 0x0})},
	{'K', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xcc, 0xd8, 0xfc, 
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'L', Character({0x0, 0x0, 0x0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 
	0xc0, 0xc0, 0xc6, 0xfe, 0x0, 0x0, 0x0, 0x0})},
	{'M', Character({0x0, 0x0, 0x0, 0xc6, 0xee, 0xfe, 0xd6, 0xc6, 
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'N', Character({0x0, 0x0, 0x0, 0xc6, 0xe6, 0xe6, 0xd6, 0xd6, 
	0xce, 0xce, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'O', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 
	0xc6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'P', Character({0x0, 0x0, 0x0, 0xfc, 0xc6, 0xc6, 0xc6, 0xfc, 
	0xc0, 0xc0, 0xc0, 0xc0, 0x0, 0x0, 0x0, 0x0})},
	{'Q', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 
	0xc6, 0xc6, 0xd6, 0x7c, 0xe, 0x6, 0x0, 0x0})},
	{'R', Character({0x0, 0x0, 0x0, 0xfc, 0xc6, 0xc6, 0xc6, 0xfc, 
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'S', Character({0x0, 0x0, 0x0, 0x7c, 0xc6, 0xc6, 0xe0, 0x7c, 
	0xe, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'T', Character({0x0, 0x0, 0x0, 0xfe, 0x18, 0x18, 0x18, 0x18, 
	0x18, 0x18, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{'U', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 
	0xc6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0})},
	{'V', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xc6, 0xc6, 0x6c, 
	0x6c, 0x38, 0x38, 0x10, 0x0, 0x0, 0x0, 0x0})},
	{'W', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 
	0xc6, 0xd6, 0xfe, 0x6c, 0x0, 0x0, 0x0, 0x0})},
	{'X', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xc6, 0x6c, 0x38, 
	0x6c, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0})},
	{'Y', Character({0x0, 0x0, 0x0, 0xc6, 0xc6, 0xc6, 0x6c, 0x38, 
	0x18, 0x18, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0})},
	{'Z', Character({0x0, 0x0, 0x0, 0xfe, 0x6, 0xc, 0x18, 0x30, 
	0x60, 0xc0, 0xc0, 0xfe, 0x0, 0x0, 0x0, 0x0})},

	// Symbols 2
	{'[', Character({0x0, 0x0, 0x7c, 0x60, 0x60, 0x60, 0x60, 0x60,
	0x60, 0x60, 0x60, 0x60, 0x7c, 0x0, 0x0, 0x0})},
	{'\'', Character({0x0, 0x0, 0x0, 0x60, 0x60, 0x60, 0x30, 0x30, 
	0x18, 0x18, 0xc, 0xc, 0xc, 0x0, 0x0, 0x0})},
	{']', Character({0x0, 0x0, 0x7c, 0xc, 0xc, 0xc, 0xc, 0xc,
	0xc, 0xc, 0xc, 0xc, 0x7c, 0x0, 0x0, 0x0})},
	{'^', Character({0x0, 0x0, 0x0, 0x10, 0x38, 0x6c, 0xc6, 0x0, 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},
	{'_', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	0x0, 0x0, 0x0, 0xfe, 0x0, 0x0, 0x0, 0x0})},
	{'`', Character({0x0, 0x0, 0x0, 0x30, 0x30, 0x18, 0x8, 0x0, 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0})},

	// Latin lowercase
	{ 'a', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0x6,
	0x7e, 0xc6, 0xc6, 0x7e, 0x0, 0x0, 0x0, 0x0}) },
	{ 'b', Character({0x0, 0x0, 0xc0, 0xc0, 0xc0, 0xc0, 0xdc, 0xe6,
	0xc6, 0xc6, 0xc6, 0xfc, 0x0, 0x0, 0x0, 0x0}) },
	{ 'c', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0xc6,
	0xc0, 0xc0, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0}) },
	{ 'd', Character({0x0, 0x0, 0x6, 0x6, 0x6, 0x6, 0x7e, 0xc6,
	0xc6, 0xc6, 0xce, 0x76, 0x0, 0x0, 0x0, 0x0}) },
	{ 'e', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0xc6,
	0xfe, 0xc0, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0}) },
	{ 'f', Character({0x0, 0x0, 0x1c, 0x36, 0x30, 0x30, 0x30, 0xfe,
	0x30, 0x30, 0x30, 0x30, 0x0, 0x0, 0x0, 0x0}) },
	{ 'g', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0xc6,
	0xc6, 0xc6, 0xc6, 0x7e, 0x6, 0xc6, 0x7c, 0x0}) },
	{ 'h', Character({0x0, 0x0, 0xc0, 0xc0, 0xc0, 0xc0, 0xdc, 0xe6,
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0}) },
	{ 'i', Character({0x0, 0x0, 0x0, 0x18, 0x18, 0x0, 0x38, 0x18,
	0x18, 0x18, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0}) },
	{ 'j', Character({0x0, 0x0, 0x0, 0x18, 0x18, 0x0, 0x38, 0x18,
	0x18, 0x18, 0x18, 0x18, 0x18, 0xd8, 0x70, 0x0}) },
	{ 'k', Character({0x0, 0x0, 0xc0, 0xc6, 0xcc, 0xd8, 0xfc, 0xe6,
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0}) },
	{ 'l', Character({0x0, 0x0, 0x38, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x18, 0x18, 0x1c, 0x0, 0x0, 0x0, 0x0}) },
	{ 'm', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xec, 0xfe,
	0xd6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0}) },
	{ 'n', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xdc, 0xe6,
	0xc6, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0}) },
	{ 'o', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0xc6,
	0xc6, 0xc6, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0}) },
	{ 'p', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfc, 0xc6,
	0xc6, 0xc6, 0xc6, 0xfc, 0xc0, 0xc0, 0xc0, 0x0}) },
	{ 'q', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0xc6,
	0xc6, 0xc6, 0xc6, 0x7e, 0x6, 0x6, 0x6, 0x0}) },
	{ 'r', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xdc, 0xe6,
	0xc6, 0xc0, 0xc0, 0xc0, 0x0, 0x0, 0x0, 0x0}) },
	{ 's', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x7c, 0xc6,
	0xf0, 0x1e, 0xc6, 0x7c, 0x0, 0x0, 0x0, 0x0}) },
	{ 't', Character({0x0, 0x0, 0x18, 0x18, 0x18, 0x18, 0x18, 0xfe,
	0x18, 0x18, 0x18, 0x18, 0x0, 0x0, 0x0, 0x0}) },
	{ 'u', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc6, 0xc6,
	0xc6, 0xc6, 0xc6, 0x7e, 0x0, 0x0, 0x0, 0x0}) },
	{ 'v', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc6, 0xc6,
	0xc6, 0x6c, 0x6c, 0x38, 0x0, 0x0, 0x0, 0x0}) },
	{ 'w', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc6, 0xc6,
	0xc6, 0xd6, 0xfe, 0x6c, 0x0, 0x0, 0x0, 0x0}) },
	{ 'x', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc6, 0xc6,
	0x7c, 0xc6, 0xc6, 0xc6, 0x0, 0x0, 0x0, 0x0}) },
	{ 'y', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc6, 0xc6,
	0xc6, 0xc6, 0xc6, 0x7e, 0x6, 0xc6, 0x7c, 0x0}) },
	{ 'z', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfe, 0x6,
	0x18, 0x30, 0xc0, 0xfe, 0x0, 0x0, 0x0, 0x0}) },

	// Symbols 3
	{ '{', Character({0x0, 0x0, 0x1c, 0x30, 0x30, 0x30, 0x30, 0x60,
	0x30, 0x30, 0x30, 0x30, 0x1c, 0x0, 0x0, 0x0}) },
	{ '|', Character({0x0, 0x0, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
	0x18, 0x18, 0x18, 0x18, 0x18, 0x0, 0x0, 0x0}) },
	{ '}', Character({0x0, 0x0, 0x38, 0xc, 0xc, 0xc, 0xc, 0x6,
	0xc, 0xc, 0xc, 0xc, 0x38, 0x0, 0x0, 0x0}) },
	{ '~', Character({0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x76,
	0xdc, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}) },
};